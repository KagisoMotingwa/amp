<script type="text/javascript">
<!--

//-->
$(document).ready(function() {

	$("#all-records-radio").click(function(){
		 $('input[name=requisition-checkbox]').prop('checked', true);
	});
	
	$("#btn-print-label").click(function(){
		var selectedRecordsIds = $('input[name=requisition-checkbox]:checked').map(function(){
			return this.value;
		}).get();
		
		var url = "{% url 'subject_dashboard_url' subject_identifier %}";
		alert(selectedRecordsIds.toString());
		var printStatus = $.ajax({
			url: url,
			type: 'GET',
			dataType: 'json',
			data: {
				'requisitionids': selectedRecordsIds.toString(),
			},
		}).promise();

		printStatus.done(function(){
			alert("all labels printed.");
		});

		printStatus.fail(function(){
			alert("Failed to print an error occurred!");
		});
	});
	
});


</script>
<hr>
<h5>Scheduled Labs  for Visit {{visit_code}}</h5>
<i> Hint: To edit the labs below, change the selected appointment's status to 'In Progress'</i>
<blockquote>
	<small>
	<label class="radio-inline"><input type="radio" id="all-records-radio" name="print-records-radio">All Records</label>
	<label class="radio-inline"><input type="radio" id="selected-records-radio" name="print-records-radio">Selected Record(s)</label> 
	<button type="button" id="btn-print-label" class="btn btn-primary btn-sm">Print</button></small>
</blockquote>
<table class="table table-condensed">
	<thead>
		<tr>
			<th>#</th>
			<th>Title</th>
			<th>Requisition</th>
			<th>Requisition identifier</th>
			<th>Status</th>
			<th>Due</th>
			<th>User</th>
			<th>Created/Modified</th>                        
			<th>Comment</th>
			<th>Browse</th>
			<th>Audit</th>                
		</tr>
	</thead>
	<tbody>
	{% for requisition in requisitions %}
    	<tr>
    		<small>
    		<td><label><input type="checkbox" name="requisition-checkbox" value="{{requisition.subject_requisition.pk}}"></label></td>
    		<td><small>{{equisition.panel_name}}</small></td>
    		<td>
    			{% if requisition.subject_requisition %}
    				<a href="{% url 'admin:amp_subjectrequisition_change' requisition.subject_requisition.pk %}?subject_visit={{requisition.subject_visit.id}}&appointment_id={{requisition.appointment.id}}&subject_identifier={{requisition.subject_identifier}}">Subject Requisition</a>
    			{% else %}
    				<a href="{% url 'admin:amp_subjectrequisition_add' %}?subject_visit={{requisition.subject_visit.id}}&appointment_id={{requisition.appointment.id}}&subject_identifier={{requisition.subject_identifier}}">Add Subject Requisition</a>
    			{% endif %}
    		</td>
    		<td>
    		{% if requisition.subject_requisition %}
    			{{ requisition.subject_requisition.requisition_identifier }}
    		{% else %}
    			---
    		{% endif %}
    		</td>
    		<td>{{requisition.entry_status}}</td>
    		<td>{{requisition.due_datetime}}</td>
    		<td>{{requisition.user_created}}</td>
    		<td>{{requisition.created}}</td>
    		<td>{{requisition.entry_comment}}</td>
    		<td>{{requisition.entry_comment}}</td>                        
			<td>{{requisition.visit_code}}</td>
			</smal>
    	</tr>
    {% endfor %}
	</tbody>
</table>